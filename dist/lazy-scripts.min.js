!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LazyScripts=t()}(this,function(){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)});var v=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.queue=[],this.callback=e}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"push",value:function(e){this.queue=[].concat(n(this.queue),n(e)),this.callback&&this.callback(this.queue)}},{key:"shift",value:function(){return this.queue.shift()}},{key:"length",value:function(){return this.queue.length}}]),t}();function S(e){return e.replace("[data-","").replace("]","").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}return function(){var n,r=function(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(i,!0).forEach(function(e){var t,n,r;t=o,r=i[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):h(i).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})}return o}({lazyScriptsInitialized:"lsi",lazyScriptSelector:"[data-lazy-script]",lazyScriptsSelector:"[data-lazy-scripts]",lazyScriptDoneSelector:"[data-lazy-script-done]",lazyScriptLoadedEventName:"lazyScriptLoaded",mutationObserverOptions:{attributes:!1,childList:!0,subtree:!0},intersectionObserverOptions:{root:null,threshold:0}},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),e=document.documentElement;if("true"!==e.dataset[r.lazyScriptsInitialized]){var o,i="",c="",a="",u=!1,s="\n    ".concat(r.lazyScriptSelector,":not(").concat(r.lazyScriptDoneSelector,"),\n    ").concat(r.lazyScriptsSelector,":not(").concat(r.lazyScriptDoneSelector,")\n  "),l={},t=document.querySelectorAll(s);e.dataset[r.lazyScriptsInitialized]=!0,document.querySelectorAll("script").forEach(function(e){e.src&&""!==e.src&&(l[e.src]=!0)}),o=new v(f),i=S(r.lazyScriptSelector),c=S(r.lazyScriptsSelector),a=S(r.lazyScriptDoneSelector),y(),b()}else console.info("ðŸ›ˆ LazyScripts already initialized");function f(){if(!u){var t=o.shift();if(t){if(t&&!l[t]){var e=document.createElement("script");return e.type="text/javascript",e.src=t,u=!0,e.dataset.lazyScript=!0,l[t]=!0,e.onload=function(){if(u=!1,f(),window.CustomEvent){var e=new CustomEvent(r.lazyScriptLoadedEventName,{detail:{scriptSrc:t}});document.body.dispatchEvent(e)}},e.onerror=function(){u=!1,l[t]=!1,f()},void document.body.appendChild(e)}0<o.length()&&window.setTimeout(function(){f()})}}}function d(e){e.dataset[i]&&o.push([e.dataset[i]]),o.push(JSON.parse(e.dataset[c]||"[]"))}function p(){t.forEach(function(e){return d(e)})}function y(){window.MutationObserver||console.info("MutationObserver not available.","DOM manipulations will not be recognised");var e=new MutationObserver(function(e,t){return function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){e.dataset&&((e.dataset[i]||e.dataset[c])&&(n?n.observe(e):p()),e.querySelectorAll(s).forEach(function(e){n?n.observe(e):p()}))})})}(e)}),t=document.querySelector("body");e.observe(t,r.mutationObserverOptions)}function b(){window.IntersectionObserver?(n=new IntersectionObserver(function(e,t){return function(e,r){e.forEach(function(e){var t=e.isIntersecting,n=e.target;t&&(d(n),n.dataset[a]=!0,r.unobserve(n))})}(e,t)},r.intersectionObserverOptions),t.forEach(function(e){n.observe(e)})):window.requestAnimationFrame?window.requestAnimationFrame(function(){return p()}):p()}}});
