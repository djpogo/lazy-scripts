!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).LazyScripts=e()}(this,function(){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)});var v=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[],this.callback=t}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(e,[{key:"push",value:function(t){this.queue=[].concat(n(this.queue),n(t)),this.callback&&this.callback(this.queue)}},{key:"shift",value:function(){return this.queue.shift()}},{key:"length",value:function(){return this.queue.length}}]),e}();function S(t){return t.replace("[data-","").replace("]","").replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})}return function(){var n,r=function(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(i,!0).forEach(function(t){var e,n,r;e=o,r=i[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):h(i).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}({lazyScriptsInitialized:"lsi",lazyScriptSelector:"[data-lazy-script]",lazyScriptsSelector:"[data-lazy-scripts]",lazyScriptDoneSelector:"[data-lazy-script-done]",lazyScriptLoadedEventName:"lazyScriptLoaded",mutationObserverOptions:{attributes:!1,childList:!0,subTree:!0}},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),t=document.documentElement;if("true"!==t.dataset[r.lazyScriptsInitialized]){var o,i="",c="",a="",u=!1,e="".concat(r.lazyScriptSelector,":not(").concat(r.lazyScriptDoneSelector,"),\n      ").concat(r.lazyScriptsSelector,":not(").concat(r.lazyScriptDoneSelector,")"),s={},l=document.querySelectorAll(e);t.dataset[r.lazyScriptsInitialized]=!0,document.querySelectorAll("script").forEach(function(t){t.src&&""!==t.src&&(s[t.src]=!0)}),o=new v(f),i=S(r.lazyScriptSelector),c=S(r.lazyScriptsSelector),a=S(r.lazyScriptDoneSelector),b(),y()}else console.info("ðŸ›ˆ LazyScripts already initialized");function f(){if(!u){var e=o.shift();if(e){if(e&&!s[e]){var t=document.createElement("script");return t.type="text/javascript",t.src=e,u=!0,t.dataset.lazyScript=!0,s[e]=!0,t.onload=function(){if(u=!1,f(),window.CustomEvent){var t=new CustomEvent(r.lazyScriptLoadedEventName,{detail:{scriptSrc:e}});document.body.dispatchEvent(t)}},t.onerror=function(){u=!1,s[e]=!1,f()},void document.body.appendChild(t)}0<o.length()&&window.setTimeout(function(){f()})}}}function p(t){t.dataset[i]&&o.push([t.dataset[i]]),o.push(JSON.parse(t.dataset[c]||"[]"))}function d(){l.forEach(function(t){return p(t)})}function y(){window.MutationObserver||console.info("MutationObserver not available.","DOM manipulations will not be recognised"),new MutationObserver(function(t,e){return function(t){t.forEach(function(t){t.addedNodes.forEach(function(t){t.dataset&&((t.dataset[i]||t.dataset[c])&&(n?n.observe(t):d()),t.querySelectorAll("".concat(r.lazyScriptSelector,", ").concat(r.lazyScriptsSelector)).forEach(function(t){n?n.observe(t):d()}))})})}(t)}).observe(document.body,r.mutationObserverOptions)}function b(){window.IntersectionObserver?(n=new IntersectionObserver(function(t,e){return function(t,r){t.forEach(function(t){var e=t.isIntersecting,n=t.target;e&&(p(n),n.dataset[a]=!0,r.unobserve(n))})}(t,e)},r.intersectionObserverOptions),l.forEach(function(t){n.observe(t)})):window.requestAnimationFrame?window.requestAnimationFrame(function(){return d()}):d()}}});
