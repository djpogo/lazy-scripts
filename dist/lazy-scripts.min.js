!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LazyScripts=t()}(this,function(){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e);var p=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.queue=[],this.callback=e}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"push",value:function(e){this.queue=[].concat(n(this.queue),n(e)),this.callback&&this.callback(this.queue)}},{key:"shift",value:function(){return this.queue.shift()}},{key:"length",value:function(){return this.queue.length}}]),t}();return function(){var n,e=function(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,r;t=o,r=i[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r})}return o}({lazyScriptSelector:"[data-lazy-script]",lazyScriptsSelector:"[data-lazy-scripts]"},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),r="",o="",i=!1,c=[],a=document.querySelectorAll("".concat(e.lazyScriptSelector,", ").concat(e.lazyScriptsSelector));function u(e){return e.replace("[data-","").replace("]","").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}function l(){if(!i){var t=n.shift();if(t)if(t&&-1===c.indexOf(t)){var e=document.createElement("script");e.type="text/javascript",e.src=t,i=!0,e.onload=function(){i=!1,c.push(t),l();var e=new CustomEvent("lazyScriptLoaded",{detail:{scriptSrc:t}});document.body.dispatchEvent(e)},document.body.appendChild(e)}else 0<n.length()&&l()}}function s(e){e.dataset[r]&&n.push([e.dataset[r]]),n.push(JSON.parse(e.dataset[o]||"[]"))}function f(){a.forEach(function(e){return s(e)})}!function(){if(document.querySelectorAll("script").forEach(function(e){c.push(e.src)}),n=new p(l),r=u(e.lazyScriptSelector),o=u(e.lazyScriptsSelector),window.IntersectionObserver){var t=new IntersectionObserver(function(e,t){return function(e,t){e.forEach(function(e){e.isIntersecting&&(s(e.target),t.unobserve(e.target))})}(e,t)},e.intersectionObserverOptions);a.forEach(function(e){t.observe(e)})}else window.requestAnimationFrame?window.requestAnimationFrame(function(){return f()}):f()}()}});
