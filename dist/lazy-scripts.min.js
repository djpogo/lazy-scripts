!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LazyScripts=t()}(this,function(){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)});var v=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.queue=[],this.callback=e}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"push",value:function(e){this.queue=[].concat(n(this.queue),n(e)),this.callback&&this.callback(this.queue)}},{key:"shift",value:function(){return this.queue.shift()}},{key:"length",value:function(){return this.queue.length}}]),t}();return function(){var n=function(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(i,!0).forEach(function(e){var t,n,r;t=o,r=i[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):b(i).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})}return o}({lazyScriptsInitialized:"lsi",lazyScriptSelector:"[data-lazy-script]",lazyScriptsSelector:"[data-lazy-scripts]",lazyScriptDoneSelector:"[data-lazy-script-done]",lazyScriptLoadedEventName:"lazyScriptLoaded",mutationObserverOptions:{attributes:!1,childList:!0,subTree:!0}},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),e=document.documentElement;if("true"!==e.dataset[n.lazyScriptsInitialized]){var r,t="",o="",i="",c=!1,a="".concat(n.lazyScriptSelector,":not(").concat(n.lazyScriptDoneSelector,"),\n      ").concat(n.lazyScriptsSelector,":not(").concat(n.lazyScriptDoneSelector,")"),u={},s=document.querySelectorAll(a);e.dataset[n.lazyScriptsInitialized]=!0,document.querySelectorAll("script").forEach(function(e){e.src&&""!==e.src&&(u[e.src]=!0)}),r=new v(f),t=l(n.lazyScriptSelector),o=l(n.lazyScriptsSelector),i=l(n.lazyScriptDoneSelector),y(),window.MutationObserver||console.info("MutationObserver not available.","DOM manipulations will not be recognised"),new MutationObserver(function(e,t){}).observe(document.body,n.mutationObserverOptions)}else console.info("ðŸ›ˆ LazyScripts already initialized");function l(e){return e.replace("[data-","").replace("]","").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}function f(){if(!c){var t=r.shift();if(t){if(t&&!u[t]){var e=document.createElement("script");return e.type="text/javascript",e.src=t,c=!0,e.dataset.lazyScript=!0,u[t]=!0,e.onload=function(){if(c=!1,f(),window.CustomEvent){var e=new CustomEvent(n.lazyScriptLoadedEventName,{detail:{scriptSrc:t}});document.body.dispatchEvent(e)}},e.onerror=function(){c=!1,u[t]=!1,f()},void document.body.appendChild(e)}0<r.length()&&window.setTimeout(function(){f()})}}}function p(e){e.dataset[t]&&r.push([e.dataset[t]]),r.push(JSON.parse(e.dataset[o]||"[]"))}function d(){s.forEach(function(e){return p(e)})}function y(){if(window.IntersectionObserver){var t=new IntersectionObserver(function(e,t){return function(e,r){e.forEach(function(e){var t=e.isIntersecting,n=e.target;t&&(p(n),n.dataset[i]=!0,r.unobserve(n))})}(e,t)},n.intersectionObserverOptions);s.forEach(function(e){t.observe(e)})}else window.requestAnimationFrame?window.requestAnimationFrame(function(){return d()}):d()}}});
